<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriSense App Prototype</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Leaflet CSS for Interactive Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .figma-container {
            width: 100%;
            max-width: 420px;
            height: 890px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1), 0 0 0 12px #1f2937;
            border-radius: 40px;
            overflow: hidden;
            position: relative;
        }
        .figma-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f8fafc;
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            transform: translateX(100%);
            overflow-y: auto;
            padding-bottom: 80px; /* Space for bottom nav */
        }
        .figma-screen.active {
            transform: translateX(0);
        }
        .status-bar {
            height: 44px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 24px;
            font-size: 15px;
            font-weight: 600;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 80px;
            background-color: #ffffff;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
        }
        .nav-btn.active svg { color: #2563eb; }
        .nav-btn.active p { color: #2563eb; }
        #map { height: 100%; width: 100%; z-index: 5;}
        /* Toggle Switch Style */
        .dot { transform: translateX(0); transition: transform 0.2s linear; }
        input:checked ~ .dot { transform: translateX(100%); }
        input:checked ~ .block { background-color: #2563eb; }
        .map-card {
            transition: transform 0.3s ease-in-out;
            transform: translateY(200%);
        }
        .map-card.active {
            transform: translateY(0);
        }
         .tab-btn.active {
            border-bottom-color: #2563eb;
            color: #2563eb;
        }
    </style>
</head>
<body class="bg-gray-800 flex items-center justify-center min-h-screen p-8">

    <div class="figma-container bg-f8fafc">
        <!-- Status Bar -->
        <div class="status-bar" id="statusBar">
            <span id="currentTime"></span>
            <div class="flex items-center gap-2 text-gray-800">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M0 11.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2zm4-3a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-5zm4-3a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-8zm4-3a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-11z"/></svg>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M15.384 6.115a.485.485 0 0 0-.047-.736A12.444 12.444 0 0 0 8 3C5.259 3 2.723 3.882.663 5.379a.485.485 0 0 0-.048.736.518.518 0 0 0 .732.05c1.86-1.323 4.212-2.13 6.653-2.13s4.793.807 6.653 2.13a.518.518 0 0 0 .732-.05z"/><path d="M13.229 8.271a.482.482 0 0 0-.063-.745A9.455 9.455 0 0 0 8 6c-2.187 0-4.134.7-5.686 1.826a.482.482 0 0 0-.063.745.525.525 0 0 0 .737.065 8.46 8.46 0 0 1 5.01-1.663 8.46 8.46 0 0 1 5.01 1.663.525.525 0 0 0 .737-.065z"/><path d="M11.072 10.424a.483.483 0 0 0-.08-.753A6.462 6.462 0 0 0 8 8.5c-1.71 0-3.236.56-4.503 1.481a.483.483 0 0 0-.08.753.54.54 0 0 0 .742.078 5.46 5.46 0 0 1 3.84-1.343 5.46 5.46 0 0 1 3.84 1.343.54.54 0 0 0 .742-.078z"/><path d="M9.03 12.574a.483.483 0 0 0-.1-.76A3.462 3.462 0 0 0 8 11c-.863 0-1.65.29-2.28.714a.483.483 0 0 0-.1.76.54.54 0 0 0 .748.085A2.46 2.46 0 0 1 8 12a2.46 2.46 0 0 1 1.282.424.54.54 0 0 0 .748-.085z"/></svg>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M2 6h10v4H2V6z"/><path d="M2 4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H2zm12 1a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-1v-4h1z"/></svg>
            </div>
        </div>

        <!-- All Screens Container -->
        <div id="screenContainer" class="w-full h-full">
            <!-- Screens are injected here by JavaScript -->
        </div>
        
        <!-- Floating Action Button for AI Chatbot -->
        <div class="absolute bottom-24 right-6 z-[1001]">
            <button class="w-16 h-16 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center" data-target="aiChatbot">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
            </button>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
             <button class="nav-btn active text-center text-gray-500" data-target="home">
                 <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                 <p class="text-xs mt-1">Home</p>
            </button>
            <button class="nav-btn text-center text-gray-500" data-target="growthTracker">
                 <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                 <p class="text-xs mt-1">Growth</p>
            </button>
             <button class="nav-btn text-center text-gray-500" data-target="stuntingHeatMap">
                 <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                 <p class="text-xs mt-1">Map</p>
            </button>
             <button class="nav-btn text-center text-gray-500" data-target="nutriEdu">
                 <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                 <p class="text-xs mt-1">Learn</p>
            </button>
            <button class="nav-btn text-center text-gray-500" data-target="communityForum">
                 <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283-.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm-3 5a5 5 0 00-4.546 2.916m5.092 0A5.002 5.002 0 0012 12a5 5 0 00-4.546 2.916m0 0a2.998 2.998 0 01-2.454-1.857M16.454 14.916a2.998 2.998 0 012.454-1.857"></path></svg>
                 <p class="text-xs mt-1">Community</p>
            </button>
        </div>

    </div>
    
    <!-- Leaflet JS for Interactive Map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        const screenContainer = document.getElementById('screenContainer');

        const screens = {
            home: `<div class="p-6 pt-20 overflow-y-auto"><div class="flex justify-between items-center"><div><p class="text-gray-500">Hello there,</p><h1 class="text-3xl font-bold text-gray-800">Maria Clara</h1></div><div class="relative cursor-pointer" data-target="profile"><div class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div></div></div><div class="mt-8 bg-red-100 border border-red-200 text-red-800 p-4 rounded-2xl flex items-center justify-between cursor-pointer" data-target="disasterMode"><div><p class="font-bold">Disaster Mode</p><p class="text-sm">Emergency nutrition info is available.</p></div><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></div><div class="mt-6 text-center"><p class="text-sm font-medium text-gray-600">Your Child's Health Score</p><div class="relative inline-block my-2"><svg class="w-32 h-32" viewBox="0 0 36 36"><path class="text-gray-200" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3"></path><path class="text-green-500" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="85, 100" stroke-dashoffset="-5"></path></svg><div class="absolute inset-0 flex flex-col items-center justify-center"><span class="text-3xl font-bold text-gray-800">85</span><span class="text-xs text-gray-500">Good</span></div></div><p class="text-xs text-gray-500">Last updated: Today</p></div><h3 class="mt-6 font-bold text-lg text-gray-800">Key Actions</h3><div class="grid grid-cols-2 gap-4 mt-2"><div class="bg-blue-100 p-4 rounded-2xl text-blue-800 cursor-pointer flex flex-col items-center justify-center text-center" data-target="symptomChecker"><svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="font-semibold text-sm">AI Symptom Checker</p></div><div class="bg-green-100 p-4 rounded-2xl text-green-800 cursor-pointer flex flex-col items-center justify-center text-center" data-target="nutriScan"><svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg><p class="font-semibold text-sm">NutriScan</p></div><div class="bg-indigo-100 p-4 rounded-2xl text-indigo-800 cursor-pointer flex flex-col items-center justify-center text-center" data-target="doctorList"><svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2z"></path></svg><p class="font-semibold text-sm">Consult a Doctor</p></div><div class="bg-purple-100 p-4 rounded-2xl text-purple-800 cursor-pointer flex flex-col items-center justify-center text-center" data-target="lockerMap"><svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7l8-4 8 4m0 6l-8 4-8-4"></path></svg><p class="font-semibold text-sm">Locker Pickup</p></div></div><h3 class="mt-6 font-bold text-lg text-gray-800">Upcoming Appointments</h3><div class="mt-2 bg-white p-4 rounded-2xl shadow-md">No appointments scheduled.</div></div>`,
            growthTracker: `<div class="p-6 pt-20"><h1 class="text-2xl font-bold text-gray-800">Growth Tracker</h1><p class="text-gray-500">Monitoring your child's progress against WHO standards.</p><div id="growthSavedAlert" class="hidden mt-4 bg-green-100 text-green-800 p-3 rounded-lg text-sm">New growth data saved successfully!</div><div class="mt-4 bg-white p-4 rounded-2xl shadow-md"><div class="w-full h-48 bg-gray-200 rounded-lg flex items-center justify-center"><svg class="w-16 h-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg></div><div class="grid grid-cols-2 gap-4 mt-4 text-center"><div><p class="text-sm text-gray-500">Height</p><p class="font-bold text-xl">85.2 cm</p><p class="text-xs text-green-600 font-semibold">Normal</p></div><div><p class="text-sm text-gray-500">Weight</p><p class="font-bold text-xl">12.5 kg</p><p class="text-xs text-green-600 font-semibold">Normal</p></div></div></div><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-6" data-target="addGrowthEntry">Add New Entry</button></div>`,
            stuntingHeatMap: `<div class="relative h-full pt-12"><div id="map"></div><div class="absolute top-16 left-0 w-full p-4 z-10"><div class="bg-white/90 backdrop-blur-sm p-4 rounded-2xl shadow-lg"><h1 class="text-xl font-bold">Stunting Heat Map: Indonesia</h1><p class="text-sm text-gray-600 mb-2">Real-time stunting prevalence.</p><div class="space-y-1 text-xs"><div class="flex items-center gap-2"><span class="w-3 h-3 bg-red-500 rounded-full border border-white"></span>High Prevalence Zone</div><div class="flex items-center gap-2"><span class="w-3 h-3 bg-yellow-400 rounded-full border border-white"></span>Medium Prevalence Zone</div><div class="flex items-center gap-2"><span class="w-3 h-3 bg-green-500 rounded-full border border-white"></span>Low Prevalence Zone</div></div><div class="mt-4 space-y-2"><label for="clinicToggle" class="flex items-center cursor-pointer"><div class="relative"><input type="checkbox" id="clinicToggle" class="sr-only"><div class="block bg-gray-300 w-10 h-6 rounded-full"></div><div class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition"></div></div><div class="ml-3 text-gray-700 font-medium text-sm">Show Nearest Puskesmas</div></label><label for="lockerToggle" class="flex items-center cursor-pointer"><div class="relative"><input type="checkbox" id="lockerToggle" class="sr-only"><div class="block bg-gray-300 w-10 h-6 rounded-full"></div><div class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition"></div></div><div class="ml-3 text-gray-700 font-medium text-sm">Find N.E.X.U.S Locker</div></label></div></div></div><div id="lockerCard" class="map-card absolute bottom-0 left-0 w-full bg-white p-6 rounded-t-3xl shadow-lg"><div class="flex items-center"><div class="p-3 bg-purple-100 rounded-lg mr-4"><svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7l8-4 8 4m0 6l-8 4-8-4"></path></svg></div><div><p class="font-bold">Central Park Locker #1</p><p class="text-sm text-gray-500">Closest to you • 5 min walk</p></div></div></div></div>`,
            nutriEdu: `<div class="p-6 pt-20"><h1 class="text-2xl font-bold text-gray-800">NutriEdu Library</h1><p class="text-gray-500">Micro-learning for a healthier family.</p><div class="mt-6 relative"><input type="text" placeholder="Search lessons..." class="w-full bg-gray-100 border-none rounded-lg py-3 pl-10 pr-10"><svg class="absolute left-3 top-3.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><button class="absolute right-3 top-3.5 text-gray-500"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg></button></div><div class="space-y-4 mt-6"><div class="bg-white p-4 rounded-xl shadow-md flex items-center gap-4 cursor-pointer" data-target="lessonDetail"><div class="w-24 h-16 bg-blue-100 rounded-lg flex items-center justify-center"><svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="flex-1"><p class="font-bold">Meal Prep for Toddlers</p><p class="text-xs text-gray-500 mt-1">Video • 5 min</p></div></div><div class="bg-white p-4 rounded-xl shadow-md flex items-center gap-4 cursor-pointer" data-target="lessonDetail"><div class="w-24 h-16 bg-green-100 rounded-lg flex items-center justify-center"><svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><div class="flex-1"><p class="font-bold">Understanding Gov't Subsidies</p><p class="text-xs text-gray-500 mt-1">Article • 3 min read</p></div></div></div></div>`,
            communityForum: `<div class="p-6 pt-20"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-800">Community Forum</h1><button class="bg-blue-600 text-white font-semibold text-sm py-2 px-4 rounded-lg" data-target="newPost">New Post</button></div><div class="space-y-4 mt-6"><div class="bg-white p-4 rounded-xl shadow-md"><div class="flex items-start gap-3"><div class="w-10 h-10 rounded-full bg-pink-200 flex items-center justify-center font-bold text-pink-700">A</div><div><p class="font-semibold text-sm">Anonymous Parent</p><p class="text-xs text-gray-400">2 hours ago</p></div></div><p class="mt-3 text-gray-700">My child refuses to eat vegetables. Any tips on how to make them more appealing?</p><div class="mt-3 text-xs flex items-center gap-4 text-gray-500"><span>2 replies</span><span>10 likes</span></div></div></div></div>`,
            profile: `<div class="p-6 pt-20"><div class="text-center"><div class="w-32 h-32 rounded-full mx-auto bg-gray-200 flex items-center justify-center"><svg class="w-16 h-16 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div><h1 class="text-2xl font-bold mt-4">Maria Clara</h1><p class="text-gray-500">Joined May 2024</p></div><div class="mt-8 space-y-2"><button class="bg-white p-4 w-full rounded-lg flex justify-between items-center shadow-sm text-left" data-target="myBadges"><span>My Badges</span><svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button><button class="bg-white p-4 w-full rounded-lg flex justify-between items-center shadow-sm text-left" data-target="linkKia"><span>Link KIA / BPJS</span><svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button><button class="bg-white p-4 w-full rounded-lg flex justify-between items-center shadow-sm text-left" data-target="settings"><span>Settings & Language</span><svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button><button class="bg-white p-4 w-full rounded-lg flex justify-between items-center shadow-sm text-left"><span>NGO / Volunteer Portal</span><svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></button></div></div>`,
            addGrowthEntry: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">Add New Growth Entry</h1><div class="mt-8 space-y-4"><div><label class="font-medium text-gray-700">Height (cm)</label><input type="number" placeholder="e.g., 85.5" class="w-full mt-1 bg-gray-100 border-gray-300 rounded-lg p-3"></div><div><label class="font-medium text-gray-700">Weight (kg)</label><input type="number" placeholder="e.g., 12.7" class="w-full mt-1 bg-gray-100 border-gray-300 rounded-lg p-3"></div></div><button id="saveGrowthBtn" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-8">Save Entry</button></div>`,
            lessonDetail: `<div class="relative"><div class="w-full h-64 bg-black flex items-center justify-center"><div class="w-full h-full bg-blue-200 flex items-center justify-center"><svg class="w-20 h-20 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="absolute inset-0 bg-black/40 flex items-center justify-center"><button class="w-16 h-16 bg-white/30 backdrop-blur-sm rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-white ml-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.002v3.996a1 1 0 001.555.832l3.197-2a1 1 0 000-1.664l-3.197-2z" clip-rule="evenodd" /></svg></button></div></div><button class="absolute top-16 left-4 text-white back-btn bg-black/30 backdrop-blur-sm p-2 rounded-full">&lt; Back</button><div class="p-6"><h1 class="text-2xl font-bold">Meal Prep for Toddlers</h1><p class="text-sm text-gray-500 mt-1">Video • 5 min</p><p class="mt-4 text-gray-700 leading-relaxed">Learn the basics of preparing nutritious and safe meals for your growing child. This lesson covers easy recipes, portion sizes, and tips to make mealtime fun and effective in preventing stunting.</p></div></div>`,
            notifications: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-gray-800">Notifications</h1><div class="space-y-4 mt-6"><div class="bg-blue-100 p-4 rounded-xl flex items-start gap-4"><div class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-1"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div><div><p class="font-semibold">Appointment Reminder</p><p class="text-sm text-blue-800">Your consultation with Dr. Rizal is tomorrow at 10:00 AM.</p><p class="text-xs text-blue-600 mt-2">1 day ago</p></div></div><div class="bg-green-100 p-4 rounded-xl flex items-start gap-4"><div class="w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-1"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg></div><div><p class="font-semibold">Time for a Growth Check-in</p><p class="text-sm text-green-800">It's been a month! Please add a new height and weight entry for your child.</p><p class="text-xs text-green-600 mt-2">3 days ago</p></div></div></div></div>`,
             aiChatbot: `<div class="flex flex-col h-full"><div class="p-4 pt-16 bg-white border-b shadow-sm"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><div class="text-center"><p class="font-bold text-gray-800">AI Health Assistant</p><p class="text-sm text-green-500">Online</p></div></div><div id="chatLog" class="flex-1 p-6 overflow-y-auto space-y-4"></div><div id="chatSuggestions" class="p-4 bg-gray-100 border-t"><div class="flex flex-wrap gap-2"></div></div><div class="p-4 bg-white border-t flex items-center"><input id="chatInput" type="text" placeholder="Type your message..." class="flex-1 bg-gray-100 border-none rounded-full py-3 px-5"><button id="sendChatBtn" class="ml-3 p-3 bg-blue-600 text-white rounded-full"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 0010 16h.001a1 1 0 00.725-.317l5-1.428a1 1 0 001.17-1.409l-7-14z"></path></svg></button></div></div>`,
            myBadges: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold">My Badges</h1><div class="grid grid-cols-3 gap-4 mt-6 text-center"><div class="text-center"><div class="w-20 h-20 bg-yellow-400 rounded-full flex items-center justify-center text-4xl mx-auto">🍲</div><p class="text-sm mt-2 font-medium">First Meal</p></div><div class="text-center"><div class="w-20 h-20 bg-blue-400 rounded-full flex items-center justify-center text-4xl mx-auto">👨‍⚕️</div><p class="text-sm mt-2 font-medium">First Consult</p></div><div class="text-center"><div class="w-20 h-20 bg-gray-300 rounded-full flex items-center justify-center text-4xl mx-auto opacity-50">📈</div><p class="text-sm mt-2 font-medium opacity-50">Growth Log</p></div></div></div>`,
            linkKia: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold">Link KIA / BPJS</h1><p class="text-gray-500 mt-2">Connect your government health accounts for seamless integration.</p></div>`,
            settings: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold">Settings</h1><div class="mt-6"><label for="language" class="font-medium text-gray-700">Language</label><select id="language" class="w-full mt-1 bg-gray-100 border-gray-300 rounded-lg p-3"><option>English</option><option>Bahasa Indonesia</option><option>Basa Jawa</option></select></div></div>`,
            newPost: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold">New Post</h1><div class="mt-6 space-y-4"><div><label class="font-medium text-gray-700">Title</label><input type="text" placeholder="e.g., Question about picky eating" class="w-full mt-1 bg-gray-100 border-gray-300 rounded-lg p-3"></div><div><label class="font-medium text-gray-700">Your question</label><textarea class="w-full h-32 bg-gray-100 border-none rounded-lg p-4" placeholder="Describe your question in detail..."></textarea></div></div><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-8">Submit Post</button></div>`,
            disasterMode: `<div class="p-6 pt-20 bg-red-800 text-white h-full"><button class="absolute top-16 left-4 text-white back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">Disaster Mode</h1><div class="text-center mt-4"><svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><div class="mt-6"><h3 class="font-semibold text-lg">Emergency Nutrition Guide</h3><p class="text-sm opacity-90 mt-2">During floods, prioritize clean water. If possible, boil water for 1 minute. Rely on non-perishable items like canned fish and fortified biscuits.</p></div><div class="mt-6"><h3 class="font-semibold text-lg">Emergency Hotlines</h3><p class="text-sm opacity-90 mt-2">National Disaster: 112<br>Local Health Unit: 021-123-456</p></div><button class="w-full bg-white text-red-800 font-bold py-4 rounded-xl mt-8">Request Drone Relief</button></div>`,
            symptomChecker: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">AI Symptom Checker</h1><p class="text-center text-gray-500 mt-2">Describe the symptoms. This is not a substitute for professional medical advice.</p><div class="mt-6"><textarea class="w-full h-32 bg-gray-100 border-none rounded-lg p-4" placeholder="e.g., my child has a fever, is tired, and has no appetite..."></textarea><div class="flex justify-end mt-2"><button class="text-gray-500"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg></button></div></div><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-4" data-target="symptomResult">Analyze Symptoms</button></div>`,
            symptomResult: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">Preliminary Analysis</h1><div class="mt-6 space-y-4"><div class="bg-yellow-100 p-4 rounded-xl"><h3 class="font-bold text-yellow-800">Possible Causes:</h3><ul class="list-disc list-inside text-sm text-yellow-700 mt-2"><li>Common flu or infection</li><li>Dehydration</li><li>Nutrient deficiency</li></ul></div><div class="bg-red-100 p-4 rounded-xl border-l-4 border-red-500"><h3 class="font-bold text-red-800">Red Flag Warning:</h3><p class="text-sm text-red-700 mt-1">High fever combined with lethargy can be serious. Please consult a doctor immediately.</p></div></div><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-8" data-target="doctorList">Consult a Doctor Now</button></div>`,
            nutriScan: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><div class="text-center mt-8"><h1 class="text-2xl font-bold">NutriScan Camera</h1><p class="text-gray-500 mt-2">Scan your ingredients to get personalized, healthy recipes and food safety alerts.</p><div class="w-full h-48 bg-gray-200 rounded-2xl flex items-center justify-center my-8"><svg class="w-20 h-20 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><button class="w-full bg-green-600 text-white font-bold py-4 rounded-xl shadow-lg shadow-green-200" data-target="cameraView"><div class="flex items-center justify-center"><svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>Scan Ingredients</div></button></div></div>`,
            cameraView: `<div class="relative h-full bg-gray-900"><div class="absolute inset-0 flex items-center justify-center text-white/50 text-lg">Camera Preview</div><div class="absolute inset-x-0 bottom-10 flex justify-center"><button class="w-20 h-20 bg-white rounded-full border-4 border-gray-400" data-target="ingredientsResult"></button></div></div>`,
            ingredientsResult: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">Ingredients Detected</h1><div class="w-full h-48 bg-gray-200 rounded-2xl flex items-center justify-center my-6"><svg class="w-20 h-20 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path></svg></div><p class="text-center text-gray-600">Our AI has identified the following items. You can remove any that are incorrect.</p><div class="flex flex-wrap gap-3 justify-center mt-6"><span class="bg-yellow-100 text-yellow-800 text-sm font-medium px-3 py-1.5 rounded-full flex items-center">Chicken Breast <button class="ml-2 text-yellow-500">x</button></span><span class="bg-orange-100 text-orange-800 text-sm font-medium px-3 py-1.5 rounded-full flex items-center">Carrots <button class="ml-2 text-orange-500">x</button></span><span class="bg-gray-200 text-gray-800 text-sm font-medium px-3 py-1.5 rounded-full flex items-center">Rice <button class="ml-2 text-gray-500">x</button></span></div><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-8 shadow-lg shadow-blue-200" data-target="recipeList">Find Recipes</button></div>`,
            recipeList: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold">Recommended Recipes</h1><p class="text-gray-500">Based on market prices & your child's needs.</p><div class="space-y-4 mt-6"><div class="bg-white p-4 rounded-xl shadow-md flex items-center gap-4 cursor-pointer" data-target="recipeDetails"><div class="w-20 h-20 bg-yellow-100 rounded-lg flex-shrink-0 flex items-center justify-center"><svg class="w-10 h-10 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4M17 3v4m2-2h-4M18 17v4m2-2h-4M12 5V3m0 18v-2M5 12H3m18 0h-2"></path></svg></div><div class="flex-1"><div class="flex items-center gap-2"><p class="font-bold">Chicken & Carrot Porridge</p><span class="text-xs font-semibold text-white bg-yellow-500 px-2 py-0.5 rounded-full">🏆 Mothers' Choice</span></div><p class="text-sm text-gray-500 mt-1">High in Protein & Vitamin A</p><div class="flex items-center gap-4 text-xs mt-1"><span class="text-blue-600 font-semibold">~180 kcal</span><span class="text-green-600 font-semibold">Affordable</span></div></div></div></div></div>`,
            recipeDetails: `<div class="relative"><div class="w-full h-72 bg-gray-200 flex items-center justify-center"><svg class="w-24 h-24 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h18v18H3zM21 15h-6m6 0v-2m-6 2v-2"></path></svg></div><button class="absolute top-16 left-4 text-gray-800 back-btn bg-white/70 backdrop-blur-sm p-2 rounded-full">&lt; Back</button><div class="p-6 bg-white rounded-t-2xl -mt-5 relative"><h1 class="text-3xl font-bold mt-2">Chicken & Carrot Porridge</h1><p class="text-gray-500 mt-2">A delicious and nutrient-packed meal perfect for supporting healthy growth.</p><div class="mt-6"><h3 class="font-bold text-lg">Ingredients</h3><ul class="list-disc list-inside mt-2 text-gray-700 space-y-1"><li>1/2 cup Rice</li><li>1 small Chicken Breast, minced</li><li>1 Carrot, grated</li><li>4 cups Water or Broth</li></ul></div><div class="mt-6"><h3 class="font-bold text-lg">Instructions</h3><ol class="list-decimal list-inside mt-2 text-gray-700 space-y-2"><li>Wash rice and add to a pot with water or broth.</li><li>Bring to a boil, then add minced chicken and grated carrot.</li><li>Reduce heat, cover, and simmer for 20-25 minutes until rice is soft and creamy.</li><li>Serve warm.</li></ol></div></div></div>`,
            doctorList: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-gray-800">Consult a Doctor</h1><p class="text-gray-500 mt-1">First, let's check the symptoms.</p><div class="mt-4 bg-blue-50 border border-blue-200 p-4 rounded-xl cursor-pointer" data-target="symptomChecker"><h3 class="font-bold text-blue-800">AI Symptom Checker</h3><p class="text-sm text-blue-700">Get a quick analysis before you consult.</p></div><div class="space-y-4 mt-6"><div class="bg-white p-4 rounded-2xl shadow-md flex items-center cursor-pointer" data-target="doctorProfile"><div class="w-16 h-16 bg-gray-200 rounded-full mr-4 flex items-center justify-center"><svg class="w-8 h-8 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div><div class="flex-1"><p class="font-bold text-gray-800">Dr. Jose Rizal</p><p class="text-sm text-gray-500">Pediatrician</p></div></div></div></div>`,
            doctorProfile: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><div class="text-center"><div class="w-32 h-32 rounded-full mx-auto bg-gray-200 flex items-center justify-center"><svg class="w-16 h-16 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div><h1 class="text-2xl font-bold mt-4">Dr. Jose Rizal</h1><p class="text-gray-500">Pediatrician</p><p class="text-green-500 font-semibold mt-1">Online</p></div><p class="text-sm text-center text-gray-600 mt-4 leading-relaxed">Specializes in child nutrition and developmental health.</p><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-8 shadow-lg shadow-blue-200" data-target="consultationMode">Consult Now</button></div>`,
            consultationMode: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">Choose Consultation Type</h1><div class="space-y-6 mt-8"><div class="border border-gray-300 p-6 rounded-2xl cursor-pointer" data-target="videoCall"><div class="flex items-center"><svg class="w-10 h-10 text-blue-600 mr-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg><div><h3 class="font-bold text-lg text-gray-800">Video Call</h3><p class="text-gray-600 text-sm">Face-to-face consultation</p></div></div></div><div class="border border-gray-300 p-6 rounded-2xl cursor-pointer" data-target="consultationChat"><div class="flex items-center"><svg class="w-10 h-10 text-blue-600 mr-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg><div><h3 class="font-bold text-lg text-gray-800">Live Chat</h3><p class="text-gray-600 text-sm">Text-based consultation</p></div></div></div></div></div>`,
            videoCall: `<div class="relative h-full bg-gray-900"><div class="absolute inset-0 flex items-center justify-center text-white/50 text-lg">Patient's Camera</div><div class="w-28 h-40 bg-gray-800 absolute top-20 right-6 rounded-lg border-2 border-white flex items-center justify-center text-white/50">Dr's Camera</div><div class="absolute inset-x-0 bottom-10 flex justify-center items-center gap-6"><button class="w-16 h-16 bg-gray-700/50 backdrop-blur-sm text-white rounded-full flex items-center justify-center"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg></button><button class="w-20 h-20 bg-red-600 text-white rounded-full flex items-center justify-center" data-target="home"><svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8l2-2m0 0l2 2m-2-2v2.5M20 12c.333-4.667-2.333-7-5-7s-5.333 2.333-5 7c.333 4.667 2.333 7 5 7s5.333-2.333 5-7z"></path></svg></button><button class="w-16 h-16 bg-gray-700/50 backdrop-blur-sm text-white rounded-full flex items-center justify-center"><svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button></div></div>`,
            consultationChat: `<div class="flex flex-col h-full"><div class="p-4 pt-16 bg-white border-b shadow-sm"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><div class="text-center"><p class="font-bold text-gray-800">Dr. Jose Rizal</p><p class="text-sm text-green-500">Online</p></div></div><div id="chatLog" class="flex-1 p-6 overflow-y-auto space-y-4"><div class="flex justify-start mb-4"><div class="bg-gray-200 p-3 rounded-lg max-w-xs">Hello Maria, how can I help you today?</div></div><div class="flex justify-end mb-4"><div class="bg-blue-600 text-white p-3 rounded-lg max-w-xs">Hi Doc, my son has had a slight fever since this morning.</div></div></div><div class="p-4 bg-white border-t flex items-center"><input id="chatInput" type="text" placeholder="Type your message..." class="flex-1 bg-gray-100 border-none rounded-full py-3 px-5"><button id="sendChatBtn" class="ml-3 p-3 bg-blue-600 text-white rounded-full"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 0010 16h.001a1 1 0 00.725-.317l5-1.428a1 1 0 001.17-1.409l-7-14z"></path></svg></button></div></div>`,
            orderTrackingLocker: `<div class="p-6 pt-20"><button class="absolute top-16 left-4 text-gray-600 back-btn">&lt; Back</button><h1 class="text-2xl font-bold text-center">Ready for Pickup</h1><div class="flex border-b mt-6"><button class="tab-btn flex-1 text-center font-semibold p-4 border-b-2 border-blue-600 text-blue-600" data-tab="qrCodeTab">QR Code</button><button class="tab-btn flex-1 text-center font-semibold p-4 border-b-2 border-transparent text-gray-500" data-tab="pinCodeTab">PIN Code</button></div><div id="qrCodeTab" class="tab-content text-center py-8"><p class="text-gray-500 mt-2">Scan this code at the N.E.X.U.S Locker to retrieve your order.</p><div class="my-8"><svg class="w-56 h-56 mx-auto" viewBox="0 0 256 256"><path fill="#1f2937" d="M184,80H160V64a32,32,0,0,0-64,0V80H72a8,8,0,0,0-8,8v96a8,8,0,0,0,8,8h24v16a8,8,0,0,0,16,0V192h16v16a8,8,0,0,0,16,0V192h24a8,8,0,0,0,8-8V88A8,8,0,0,0,184,80ZM112,64a16,16,0,0,1,32,0V80H112Z"/></svg></div></div><div id="pinCodeTab" class="tab-content text-center py-8 hidden"><p class="text-gray-500 mt-2">Enter this code on the locker's keypad to retrieve your order.</p><p class="text-6xl font-bold tracking-widest my-16">11-23-58</p></div></div>`,
            lockerMap: `<div class="relative h-full pt-12"><div id="locker_map"></div><div class="absolute top-16 left-0 w-full p-4 z-10"><div class="bg-white/90 backdrop-blur-sm p-4 rounded-2xl shadow-lg"><h1 class="text-xl font-bold">Find Nearest Locker</h1><p class="text-sm text-gray-600">Centered on your location in Medit.</p></div></div><div class="map-card active absolute bottom-0 left-0 w-full bg-white p-6 rounded-t-3xl shadow-lg"><div class="flex items-center"><div class="p-3 bg-purple-100 rounded-lg mr-4"><svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7l8-4 8 4m0 6l-8 4-8-4"></path></svg></div><div><p class="font-bold">Central Park Locker #1</p><p class="text-sm text-gray-500">Closest to you • 5 min walk</p></div></div><button class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl mt-4" data-target="orderTrackingLocker">Confirm Locker</button></div></div>`,
        };
        
        function initApp() {
            Object.keys(screens).forEach(key => {
                const screenDiv = document.createElement('div');
                screenDiv.id = key;
                screenDiv.classList.add('figma-screen');
                screenDiv.innerHTML = screens[key];
                screenContainer.appendChild(screenDiv);
            });
            document.getElementById('home').classList.add('active');
        }
        initApp();

        let screenHistory = ['home']; 
        let map;
        let locker_map;
        let clinicMarkers = L.layerGroup();
        let lockerMarkers = L.layerGroup();
        const initialMapView = { center: [-2.5, 118], zoom: 5 };
        const jakartaView = { center: [-6.176, 106.79], zoom: 15 };

        function showScreen(screenId, isBack = false) {
            const activeScreen = document.querySelector('.figma-screen.active');
            const targetScreen = document.getElementById(screenId);

            if (!targetScreen) return;
            
            if (activeScreen) activeScreen.classList.remove('active');
            targetScreen.classList.add('active');
            
            if (!isBack) {
                if (screenHistory[screenHistory.length - 1] !== screenId) {
                     screenHistory.push(screenId);
                }
            }
            if ([...document.querySelectorAll('.nav-btn')].some(btn => btn.dataset.target === screenId)) {
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.target === screenId));
            }

            if (screenId === 'stuntingHeatMap') {
                setTimeout(() => initializeStuntingMap(), 50);
            }
            if (screenId === 'lockerMap') {
                 setTimeout(() => initializeLockerMap(), 50);
            }
            if (screenId === 'aiChatbot') {
                 initializeChatbot();
            }
        }

        function goBack() {
             if (screenHistory.length > 1) {
                screenHistory.pop();
                const previousScreenId = screenHistory[screenHistory.length - 1];
                showScreen(previousScreenId, true);
             }
        }
        
        document.body.addEventListener('click', (e) => {
             const targetButton = e.target.closest('[data-target]');
             if (targetButton) {
                 e.stopPropagation();
                 const targetId = targetButton.dataset.target;
                 if (targetButton.classList.contains('nav-btn')) {
                    screenHistory = [targetId];
                 }
                 showScreen(targetId);
             } else if (e.target.closest('.back-btn')) {
                 e.stopPropagation();
                 goBack();
             } else if (e.target.closest('#saveGrowthBtn')) {
                 const growthSavedAlert = document.getElementById('growthSavedAlert');
                 if (growthSavedAlert) growthSavedAlert.classList.remove('hidden');
                 goBack();
                 setTimeout(() => { if(growthSavedAlert) growthSavedAlert.classList.add('hidden'); }, 3000);
             } else if (e.target.closest('#sendChatBtn')) {
                 const chatInput = document.getElementById('chatInput');
                 const text = chatInput.value.trim();
                 if (text) {
                     addChatMessage('user', text);
                     chatInput.value = '';
                     document.getElementById('chatSuggestions').innerHTML = '';
                     setTimeout(() => addChatMessage('ai', 'I am a demo chatbot. Thanks for your message!'), 500);
                 }
             } else if (e.target.classList.contains('tab-btn')) {
                const parent = e.target.closest('.figma-screen');
                parent.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active', 'text-blue-600', 'border-blue-600'));
                e.target.classList.add('active', 'text-blue-600', 'border-blue-600');
                parent.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
                parent.querySelector(`#${e.target.dataset.tab}`).classList.remove('hidden');
             }
        });
        
        function updateTime() {
            const timeEl = document.getElementById('currentTime');
            if(timeEl) {
                timeEl.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });
            }
        }
        setInterval(updateTime, 1000);
        updateTime();

        // --- AI Chatbot Logic ---
        const chatScript = [
            { from: 'ai', text: 'Hello! I am your NutriSense AI Assistant. How can I help you today?' },
            { from: 'user', suggestions: ['What are symptoms of stunting?', 'Find healthy recipes', 'When is my next appointment?'] },
            { from: 'ai', responseTo: 'What are symptoms of stunting?', text: 'Common signs of stunting include being shorter than other children of the same age, slow weight gain, and frequent illness. It is best to consult a doctor for a proper diagnosis.' },
            { from: 'ai', responseTo: 'Find healthy recipes', text: 'Of course! I can help with that. What ingredients do you have available?' },
            { from: 'ai', responseTo: 'When is my next appointment?', text: 'Your next appointment is with Dr. Rizal tomorrow at 10:00 AM. Would you like me to confirm it?' }
        ];

        function addChatMessage(from, text) {
            const chatLog = document.getElementById('chatLog');
            if (!chatLog) return;
            const bubble = document.createElement('div');
            bubble.classList.add('flex', 'mb-4');
            bubble.innerHTML = `<div class="${from === 'user' ? 'bg-blue-600 text-white ml-auto' : 'bg-gray-200'} p-3 rounded-lg max-w-xs">${text}</div>`;
            chatLog.appendChild(bubble);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        function showSuggestions(suggestions) {
            const chatSuggestionsContainer = document.getElementById('chatSuggestions');
            if (!chatSuggestionsContainer) return;
            chatSuggestionsContainer.innerHTML = '<div class="flex flex-wrap gap-2"></div>';
            suggestions.forEach(suggestion => {
                const button = document.createElement('button');
                button.className = 'bg-blue-100 text-blue-700 text-sm font-medium px-3 py-1.5 rounded-full';
                button.textContent = suggestion;
                button.onclick = () => {
                    addChatMessage('user', suggestion);
                    const aiResponse = chatScript.find(item => item.responseTo === suggestion);
                    if(aiResponse) setTimeout(() => addChatMessage('ai', aiResponse.text), 500);
                    chatSuggestionsContainer.innerHTML = '';
                };
                chatSuggestionsContainer.querySelector('div').appendChild(button);
            });
        }
        
        function initializeChatbot() {
            const chatLog = document.getElementById('chatLog');
            if(chatLog && !chatLog.dataset.initialized) {
                chatLog.dataset.initialized = true;
                chatLog.innerHTML = '';
                addChatMessage('ai', chatScript[0].text);
                showSuggestions(chatScript[1].suggestions);
            }
        }

        // --- Map Initialization ---
        function initializeStuntingMap() {
             if (document.getElementById('map') && !map) {
                map = L.map('map').setView(initialMapView.center, initialMapView.zoom);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '© OpenStreetMap' }).addTo(map);
                const heatZones = [ { lat: -6.9, lng: 107.6, radius: 100000 }, { lat: 3.5, lng: 98.6, radius: 80000 }, { lat: -8.4, lng: 115.1, radius: 50000 }];
                heatZones.forEach(zone => L.circle([zone.lat, zone.lng], { color: 'red', fillColor: 'red', fillOpacity: 0.3, radius: zone.radius }).addTo(map));
                const puskesmasLocations = [ { lat: -6.17539, lng: 106.82715, name: "Puskesmas Gambir" }, { lat: -6.19, lng: 106.83, name: "Puskesmas Menteng" }];
                const puskesmasIcon = L.icon({ iconUrl: `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%233b82f6'%3E%3Cpath d='M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z'/%3E%3C/svg%3E`, iconSize: [24, 24], iconAnchor: [12, 24], popupAnchor: [0, -24] });
                puskesmasLocations.forEach(p => L.marker([p.lat, p.lng], {icon: puskesmasIcon}).bindPopup(p.name).addTo(clinicMarkers));
                const lockerLocations = [{ lat: -6.178, lng: 106.8, name: "Central Park Locker #1" }, { lat: -6.17, lng: 106.82, name: "Medit Locker #2" }];
                const lockerIcon = L.icon({ iconUrl: `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%238b5cf6'%3E%3Cpath d='M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7l8-4 8 4m0 6l-8 4-8-4'/%3E%3C/svg%3E`, iconSize: [32, 32], iconAnchor: [16, 16] });
                lockerLocations.forEach(l => L.marker([l.lat, l.lng], {icon: lockerIcon}).bindPopup(l.name).addTo(lockerMarkers));

                document.getElementById('clinicToggle').addEventListener('change', function(e) {
                    if (e.target.checked) {
                        document.getElementById('lockerToggle').checked = false;
                        map.removeLayer(lockerMarkers);
                        document.getElementById('lockerCard').classList.remove('active');
                        map.flyTo(jakartaView.center, 13, { animate: true, duration: 1.5 }); map.addLayer(clinicMarkers);
                    } else {
                        map.removeLayer(clinicMarkers); map.flyTo(initialMapView.center, initialMapView.zoom);
                    }
                });
                document.getElementById('lockerToggle').addEventListener('change', function(e) {
                    if (e.target.checked) {
                        document.getElementById('clinicToggle').checked = false;
                        map.removeLayer(clinicMarkers);
                        map.flyTo(jakartaView.center, 14, { animate: true, duration: 1.5 });
                        map.addLayer(lockerMarkers);
                        document.getElementById('lockerCard').classList.add('active');
                    } else {
                        map.removeLayer(lockerMarkers);
                        document.getElementById('lockerCard').classList.remove('active');
                        map.flyTo(initialMapView.center, initialMapView.zoom);
                    }
                });
            }
        }
        function initializeLockerMap() {
             if (document.getElementById('locker_map') && !locker_map) {
                locker_map = L.map('locker_map').setView(jakartaView.center, jakartaView.zoom);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '© OpenStreetMap' }).addTo(locker_map);
                const lockerLocations = [{ lat: -6.178, lng: 106.8, name: "Central Park Locker #1", selected: true }, { lat: -6.17, lng: 106.82, name: "Medit Locker #2" }];
                const lockerIcon = L.icon({ iconUrl: `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%238b5cf6'%3E%3Cpath d='M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7l8-4 8 4m0 6l-8 4-8-4'/%3E%3C/svg%3E`, iconSize: [32, 32], iconAnchor: [16, 16] });
                lockerLocations.forEach(l => L.marker([l.lat, l.lng], {icon: lockerIcon}).bindPopup(l.name).addTo(locker_map));
             }
        }
    </script>
</body>
</html>
